From f78e4cd4c0967198f75a2afe0a826312c62e0874 Mon Sep 17 00:00:00 2001
From: Frankie Dintino <fdintino@gmail.com>
Date: Wed, 26 Oct 2022 20:55:56 -0400
Subject: [PATCH] Disable passing AOM_USAGE_REALTIME to aom_encode

see https://github.com/AOMediaCodec/libavif/issues/1190
---
 src/codec_aom.c | 9 ---------
 1 file changed, 9 deletions(-)

diff --git a/src/codec_aom.c b/src/codec_aom.c
index abd16da..5601c27 100644
--- a/src/codec_aom.c
+++ b/src/codec_aom.c
@@ -557,15 +557,6 @@ static avifResult aomCodecEncodeImage(avifCodec * codec,
         int aomCpuUsed = -1;
         if (encoder->speed != AVIF_SPEED_DEFAULT) {
             aomCpuUsed = AVIF_CLAMP(encoder->speed, 0, 9);
-            if (aomCpuUsed >= 7) {
-#if defined(AOM_USAGE_ALL_INTRA) && defined(ALL_INTRA_HAS_SPEEDS_7_TO_9)
-                if (!(addImageFlags & AVIF_ADD_IMAGE_FLAG_SINGLE)) {
-                    aomUsage = AOM_USAGE_REALTIME;
-                }
-#else
-                aomUsage = AOM_USAGE_REALTIME;
-#endif
-            }
         }
 
         // aom_codec.h says: aom_codec_version() == (major<<16 | minor<<8 | patch)
-- 
2.30.0

